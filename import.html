<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Import statistik ze zápasu (OCR)</title>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f2f2f2}
.wrapper{max-width:1200px;margin:0 auto;background:white;padding:30px}
table{border-collapse:collapse;width:100%;margin-top:20px}
th,td{border:1px solid #999;padding:6px 8px;text-align:center}
th{background:#cfe8f7}
.left{text-align:left}
.upload{margin:20px 0;padding:20px;border:2px dashed #22a6df;text-align:center}
.filters{margin:10px 0;padding:10px;background:#eef6fb}
button{padding:6px 10px}
dialog{padding:20px}
.summary{margin-top:10px;font-weight:bold}
</style>
</head>

<body>
<div class="wrapper">

<h1>Import statistik ze zápasu (OCR)</h1>

<div class="upload">
<input type="file" id="img" accept="image/*">
</div>

<div class="filters">
Hráč:
<select id="filterPlayer">
<option value="">Vše</option>
<option>Pici</option>
<option>Kubele</option>
</select>

Tým:
<select id="filterTeam"><option value="">Vše</option></select>

Kategorie:
<select id="filterCategory">
<option value="">Vše</option>
<option>OH</option>
<option>Extraliga - základní část</option>
<option>Extraliga - play off</option>
</select>
</div>

<table id="statsTable">
<thead>
<tr>
<th>Tým</th>
<th>Role</th>
<th>Góly vstř.</th>
<th>Góly ink.</th>
<th>Hity dané</th>
<th>Hity obdrž.</th>
<th>Vhaz. vyhr.</th>
<th>Vhaz. prohr.</th>
<th>Čas v útoku</th>
<th>Čas v obraně</th>
<th>Přesilovky</th>
<th>Využ. PP</th>
<th>OT</th>
<th>Kategorie</th>
<th>Hráč</th>
<th>Akce</th>
</tr>
</thead>
<tbody></tbody>
</table>

<div class="summary" id="summary"></div>

</div>

<dialog id="editDialog">
<h3>Aktualizace zápasu</h3>

Kategorie:<br>
<select id="dlgCategory">
<option>OH</option>
<option>Extraliga - základní část</option>
<option>Extraliga - play off</option>
</select><br><br>

Tým (hráč):<br>
<select id="dlgPlayer">
<option>Kubele</option>
<option>Pici</option>
</select><br><br>

<button onclick="saveEdit()">Uložit</button>
<button onclick="editDialog.close()">Zavřít</button>
</dialog>

<script>

/* ===== MAPA TÝMŮ ===== */

const TEAM_MAP = {
  "SPA":["SPA","SPARTA"],
  "LIB":["LIB","LIBEREC","TYGRI"],
  "KLA":["KLA","KLADNO"],
  "TRI":["TRI","TRINEC"],
  "PAR":["PAR","PARDUBICE"],
  "LIT":["LIT","LITVINOV"],
  "PLZ":["PLZ","PLZEN"],
  "ZLN":["ZLN","ZLIN"],
  "VIT":["VIT","VITKOVICE"]
};

const TEAM_NAMES = {
  "SPA":"HC Sparta Praha",
  "LIB":"HC Bílí Tygři Liberec",
  "KLA":"HC Geus Okna Kladno",
  "TRI":"HC Oceláři Třinec",
  "PAR":"HC Dynamo Pardubice",
  "LIT":"HC Litvínov",
  "PLZ":"HC Plzeň",
  "ZLN":"HC Zlín",
  "VIT":"HC Vítkovice"
};

let allMatches=[];
let editIndex=null;

/* ===== HELPERS ===== */

function findLine(t,k){
  return t.split("\n").find(l=>l.includes(k))||"";
}

function numbers(l){
  return l.match(/[0-9:]+/g)||[];
}

function va
