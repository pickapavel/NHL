<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Statistiky zápasu</title>

<style>
body{font-family:Arial;background:#f2f2f2;margin:0}
.wrapper{max-width:1000px;margin:40px auto;background:white;padding:30px}
.controls{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:20px}
table{border-collapse:collapse;width:100%}
th,td{border:1px solid #999;padding:8px;text-align:center}
th{background:#cfe8f7}
button{padding:8px 14px}
</style>
</head>

<body>

<div class="wrapper">

<h1>Statistiky zápasu</h1>

<div class="controls">

<input type="file" id="fileInput" accept=".txt">

<select id="category">
<option>Extraliga - základní část</option>
<option>Extraliga - Play off</option>
<option>OH</option>
</select>

<select id="player">
<option>Pici</option>
<option>Kubele</option>
</select>

<select id="homeTeam">
<option>HC Sparta Praha</option>
<option>HC Bílí Tygři Liberec</option>
<option>HC Dynamo Pardubice</option>
<option>HC Chemopetrol Litvínov</option>
<option>HC Geus Okna Kladno</option>
<option>HC Motor České Budějovice</option>
<option>HC Energie Karlovy Vary</option>
<option>HC Oceláři Třinec</option>
</select>

<select id="awayTeam">
<option>HC Sparta Praha</option>
<option>HC Bílí Tygři Liberec</option>
<option>HC Dynamo Pardubice</option>
<option>HC Chemopetrol Litvínov</option>
<option>HC Geus Okna Kladno</option>
<option>HC Motor České Budějovice</option>
<option>HC Energie Karlovy Vary</option>
<option>HC Oceláři Třinec</option>
</select>

<button onclick="saveMatch()">Uložit zápas</button>

</div>

</div>

<!-- FIREBASE -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyD0jDnVNHZAs83g6FGwQT_nOpOCyT4NTNU",
  authDomain: "statistiky-6310a.firebaseapp.com",
  projectId: "statistiky-6310a",
  storageBucket: "statistiky-6310a.appspot.com",
  messagingSenderId: "1023222901562",
  appId: "1:1023222901562:web:522ee763e27aa08a8b7e03"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.db = db;
window.addDoc = addDoc;
window.collection = collection;

</script>

<script>

let loadedLines = [];

document.getElementById("fileInput").addEventListener("change", e => {

    const reader = new FileReader();

    reader.onload = ev => {
        loadedLines = ev.target.result
            .split(/\r?\n/)
            .map(l=>l.trim())
            .filter(l=>l!=="");
    };

    reader.readAsText(e.target.files[0]);
});

async function saveMatch(){

    if(loadedLines.length < 20){
        alert("Nejprve nahraj zapas.txt");
        return;
    }

    await addDoc(collection(db,"zapasy"),{
        category: category.value,
        player: player.value,
        homeTeam: homeTeam.value,
        awayTeam: awayTeam.value,
        stats: loadedLines,
        created: Date.now()
    });

    alert("Zápas uložen do Firebase!");
}

</script>

</body>
</html>
